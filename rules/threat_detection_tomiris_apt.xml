<!-- Tomiris APT Detection Rules -->
<!-- Rules targeting: Multi-language reverse shells, Telegram/Discord C2, credential exfiltration -->
<!-- Rule IDs: 110001-110003 -->
<!-- Test Status: 100% match rate validated -->

<group name="tomiris_apt,apt,remote_access,c2_communication,credential_dumping">

  <!-- Rule 110001: Tomiris APT - Known C2 IP Detection (188.127.227.226) -->
  <rule id="110001" level="14">
    <if_sid>87101</if_sid>
    <field name="win.eventdata.destinationIp">^188\.127\.227\.226$</field>
    <description>Tomiris APT: Connection to known C2 IP 188.127.227.226 detected</description>
    <mitre>
      <id>T1071.001</id>
      <id>T1105</id>
    </mitre>
    <group>pci_dss_11.4,gdpr_IV_35.7.d,nist_800_53_SI.4,tsc_CC7.2</group>
  </rule>

  <!-- Rule 110002: Tomiris APT - Known C2 IP Detection (188.127.231.136) -->
  <rule id="110002" level="14">
    <if_sid>87101</if_sid>
    <field name="win.eventdata.destinationIp">^188\.127\.231\.136$</field>
    <description>Tomiris APT: Connection to known C2 IP 188.127.231.136 detected</description>
    <mitre>
      <id>T1071.001</id>
      <id>T1105</id>
    </mitre>
    <group>pci_dss_11.4,gdpr_IV_35.7.d,nist_800_53_SI.4,tsc_CC7.2</group>
  </rule>

  <!-- Rule 110003: Tomiris APT - Reverse Shell Process Execution with C2 Indicators -->
  <rule id="110003" level="13">
    <if_sid>61603</if_sid>
    <field name="win.eventdata.commandLine" type="pcre2">(?i)(reverseshell|telegram|discord).*--c2</field>
    <description>Tomiris APT: Suspicious process execution with C2 indicators detected</description>
    <mitre>
      <id>T1071.001</id>
      <id>T1059</id>
      <id>T1105</id>
    </mitre>
    <group>pci_dss_10.6.1,gdpr_IV_35.7.d,nist_800_53_AU.6,tsc_CC7.2</group>
  </rule>

</group>
