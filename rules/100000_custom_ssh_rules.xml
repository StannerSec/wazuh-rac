<!--
    Custom SSH Detection Rules
    Rule ID Range: 100100-100199
  -->

  <group name="ssh,syslog,">

    <!-- Rule: SSH brute force attempt -->
    <rule id="100100" level="10">
      <if_group>syslog</if_group>
      <match>Failed password</match>
      <description>SSH: Multiple failed password attempts (Brute force)</description>
      <mitre>
        <id>T1110.001</id>
      </mitre>
    </rule>

    <!-- Rule: SSH successful login after failures -->
    <rule id="100101" level="12">
      <if_sid>100100</if_sid>
      <match>Accepted password</match>
      <description>SSH: Successful login after brute force attempts</description>
      <mitre>
        <id>T1078</id>
      </mitre>
    </rule>

    <!-- Rule: SSH login from unusual country -->
    <rule id="100102" level="8">
      <if_group>syslog</if_group>
      <match>Accepted publickey|Accepted password</match>
      <description>SSH: Successful authentication</description>
    </rule>

  </group>
